import{c as j,j as t,r as c,a as o}from"./assets/client-9fe1ee54.js";const x="https://hyperexplainer-backend-695116221974.us-central1.run.app";console.log("[HyperExplainer][Popup] Using BACKEND =",x);function F(){const[N,w]=c.useState(""),[n,P]=c.useState([]),[l,u]=c.useState(!1),[d,h]=c.useState(null),[m,y]=c.useState("all"),[T,b]=c.useState({}),[p,f]=c.useState("neural"),[g]=c.useState({categories:{architecture:["units","layer","shape","hidden","filters","kernel","pool","dense","dropout","conv","lstm","hidden_layer_size","output_layer_size","output_units","input_shape"],preprocessing:["normalization","scaling","factor","augmentation","resize","normalization_factor","standardization"],activation:["activation","relu","sigmoid","tanh","softmax","leaky","swish","mish","gelu"],optimization:["optimizer","learning_rate","momentum","decay","beta","adam","sgd","rmsprop"],training:["epochs","batch","steps","patience","callbacks","monitor"],evaluation:["loss","metric","accuracy","precision","recall","f1","auc","mae"],regularization:["dropout","l1","l2","regulariz","penalty"]},displayNames:{architecture:"NETWORK ARCHITECTURE",preprocessing:"DATA PREPROCESSING",activation:"ACTIVATION FUNCTIONS",optimization:"OPTIMIZATION",training:"TRAINING PARAMETERS",evaluation:"EVALUATION METRICS",regularization:"REGULARIZATION",other:"OTHER PARAMETERS"},impacts:{high:["learning_rate","optimizer","loss","epochs","batch_size"],medium:["dropout","activation","layers","units","hidden_layer_size"],low:["momentum","beta","epsilon","seed","normalization_factor"]}}),A=e=>{const a=e.toLowerCase();for(const[s,i]of Object.entries(g.categories))if(i.some(r=>a.includes(r)))return s;return"other"},I=e=>{const a=e.toLowerCase();return g.impacts.high.some(s=>a.includes(s))?"High":g.impacts.medium.some(s=>a.includes(s))?"Medium":"Low"},k=e=>{const a=e.toLowerCase();return a.includes("torch")||a.includes("nn.")?"PyTorch":a.includes("tf.")||a.includes("keras")?"TensorFlow":"Common"};c.useEffect(()=>{if(n.length>0){const e={};n.forEach(i=>{const r=i.category||"other";e[r]||(e[r]=[]),e[r].push(i)});const a={};["architecture","activation","optimization","training","evaluation","regularization","other"].forEach(i=>{var r;((r=e[i])==null?void 0:r.length)>0&&(a[i]=e[i])}),b(a)}},[n]);const E=async e=>{try{u(!0),h(null),console.log(`[HyperExplainer][Popup] Sending extract request using method: ${p}`);const a=await fetch(`${x}/extract`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:e,method:p})});if(console.log("[HyperExplainer][Popup] HTTP status:",a.status),!a.ok)throw new Error(`HTTP ${a.status}: ${a.statusText}`);const s=await a.json();console.log("[HyperExplainer][Popup] Extract response JSON:",s);const i=Object.entries(s).map(([r,C])=>{const _=C===null?"null":String(C),L=A(r),U=I(r),$=k(r);return{name:r,value:_,impact:U,framework:$,category:L}});try{chrome.storage.local.set({hyperparams:Object.fromEntries(i.map(r=>[r.name,r.value]))})}catch(r){console.warn("Could not store params to chrome storage",r)}P(i)}catch(a){console.error("[HyperExplainer][Popup] Extract failed:",a),h(a.message||"Unknown error")}finally{u(!1)}};c.useEffect(()=>{console.log("[HyperExplainer][Popup] Popup mounted, reading storage");try{chrome.storage.local.get("latestCode",async e=>{try{const a=e.latestCode||"";if(console.log("[HyperExplainer][Popup] Got latestCode from storage:",a),w(a),!a){console.log("[HyperExplainer][Popup] No code snippet found, nothing to extract");return}E(a)}catch(a){console.error("[HyperExplainer][Popup] Error processing storage data:",a),h("Error loading data. Please try again."),u(!1)}})}catch(e){console.error("[HyperExplainer][Popup] Error accessing chrome storage:",e),h("Error accessing extension storage. Please reload the extension."),u(!1)}},[]),c.useEffect(()=>{N&&E(N)},[p]);const H=e=>{try{console.log("[HyperExplainer][Popup] Opening detail for:",e);const a=chrome.runtime.getURL(`detail.html?name=${encodeURIComponent(e.name)}&value=${encodeURIComponent(e.value||"")}`);chrome.tabs.create({url:a})}catch(a){console.error("[HyperExplainer][Popup] Error opening detail view:",a)}},z=n.filter(e=>m==="all"?!0:e.framework===m),S={TensorFlow:n.filter(e=>e.framework==="TensorFlow"),PyTorch:n.filter(e=>e.framework==="PyTorch"),Common:n.filter(e=>e.framework==="Common")},R=e=>e?e==="High"?"high-impact":e==="Medium"?"medium-impact":"low-impact":"",M=e=>e?e==="High"?"impact-high":e==="Medium"?"impact-medium":"impact-low":"",v=e=>o("div",{className:`card ${R(e.impact)}`,onClick:()=>H(e),children:[t("span",{className:"card-name",children:e.name}),o("div",{className:"card-details",children:[o("div",{className:"card-value-section",children:[t("span",{className:"card-label",children:"Value:"}),t("span",{className:"card-value",children:e.value})]}),o("div",{className:"card-impact-section",children:[t("span",{className:"card-label",children:"Impact:"}),t("span",{className:`card-impact ${M(e.impact)}`,children:e.impact||"Medium"})]})]}),t("span",{className:"card-arrow",children:"→"})]},e.name),O=()=>{switch(p){case"naive":return"Naive Approach";case"classical":return"Classical ML";case"neural":return"Neural Network";default:return"Neural Network"}};return o("div",{className:"popup-container",children:[t("h1",{children:"HyperExplainer"}),t("p",{className:"subtitle",children:"AI-powered hyperparameter analysis"}),o("div",{className:"extraction-method",children:[t("div",{className:"extraction-label",children:"Extraction Method:"}),o("div",{className:"method-options",children:[o("label",{className:"method-option",children:[t("input",{type:"radio",name:"extractionMethod",value:"neural",checked:p==="neural",onChange:()=>f("neural")}),t("span",{children:"Neural Network (Deep Learning)"})]}),o("label",{className:"method-option",children:[t("input",{type:"radio",name:"extractionMethod",value:"classical",checked:p==="classical",onChange:()=>f("classical")}),t("span",{children:"Classical ML (Feature-based)"})]}),o("label",{className:"method-option",children:[t("input",{type:"radio",name:"extractionMethod",value:"naive",checked:p==="naive",onChange:()=>f("naive")}),t("span",{children:"Naive (Pattern Matching)"})]})]})]}),!l&&!d&&n.length>0&&o("div",{className:"info-row",children:[t("span",{className:"info-icon",children:"ℹ️"}),o("span",{className:"info-text",children:["Found ",n.length," hyperparameters",t("span",{className:`method-badge ${p}`,children:O()})]})]}),!l&&!d&&n.length>0&&o("div",{className:"tabs",children:[t("div",{className:`tab ${m==="all"?"active":""}`,onClick:()=>y("all"),children:"All"}),Object.entries(S).map(([e,a])=>a.length>0?t("div",{className:`tab ${m===e?"active":""}`,onClick:()=>y(e),children:e},e):null)]}),l&&t("p",{className:"hint",children:"Analyzing code…"}),!l&&d&&o("p",{className:"error",children:["Error fetching hyperparameters: ",d]}),!l&&!d&&n.length===0&&t("p",{className:"hint",children:N?"No hyperparameters found.":"Waiting for code…"}),!l&&!d&&n.length>0&&m==="all"&&Object.entries(T).map(([e,a])=>o("div",{className:"param-category",children:[t("div",{className:"section-header",children:g.displayNames[e]||e.toUpperCase()}),t("div",{className:"cards",children:a.map(s=>v(s))})]},e)),!l&&!d&&m!=="all"&&t("div",{className:"cards",children:z.map(e=>v(e))}),!l&&!d&&n.length>0&&t("button",{className:"action-button",onClick:()=>{const e=chrome.runtime.getURL("detail.html?fullAnalysis=true");chrome.tabs.create({url:e})},children:"See detailed analysis"}),!l&&!d&&n.length>0&&t("div",{className:"footer",children:"Powered by Google Cloud Vertex AI"})]})}const G=document.getElementById("root");j(G).render(t(F,{}));
